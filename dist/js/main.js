(()=>{"use strict";const e=e=>{const t=document.createElement("div");t.classList.add("modal-backdrop"),t.classList.add("fade"),document.body.append(t),setTimeout((()=>{t&&t.classList.add("show"),e.classList.add("show")}),100),e.classList.add("d-block"),setTimeout((()=>{e.classList.add("show")}),100)},t=e=>{const t=document.querySelector(".modal-backdrop");e.classList.remove("show"),t&&t.classList.remove("show"),setTimeout((()=>{e.style.display="none",t&&t.remove()}),500)},n=e=>fetch("http://localhost:3001"+e).then((e=>{if(!e.ok)throw new Error("Ошибка получения  данных");return e.json()}));(()=>{const o=document.getElementById("open-auth-btn"),c=document.getElementById("auth-modal"),s=c.querySelectorAll(".close-btn"),l=c.querySelector(".login-btn"),a=document.getElementById("open-cart-btn"),d=document.getElementById("logout-btn"),r=()=>{o.classList.add("d-none"),a.classList.remove("d-none"),d.classList.remove("d-none"),t(c)};o.addEventListener("click",(()=>{e(c)})),s.forEach((e=>{e.addEventListener("click",(()=>{t(c)}))})),l.addEventListener("click",(()=>{const e=c.querySelector("#login-control"),t=c.querySelector("#password-control"),o={login:e.value,password:t.value};n("/profile").then((e=>{console.log(e),e.login===o.login&&e.password===o.password?(localStorage.setItem("auth",JSON.stringify(o)),r()):alert("неудасча")}))})),d.addEventListener("click",(()=>{localStorage.removeItem("auth"),o.classList.remove("d-none"),a.classList.add("d-none"),d.classList.add("d-none")})),(()=>{const e=JSON.parse(localStorage.getItem("auth"));e&&n("/profile").then((t=>{t.login===e.login&&t.password===e.password&&r()}))})()})(),(()=>{const e=document.getElementById("categories-container");n("/categories").then((t=>{(t=>{t.forEach((t=>{e.insertAdjacentHTML("beforeend",`\n                        <div class="col col-12 col-md-6 col-lg-4 mb-3">\n                              <a href="/catalog.html?id=${t.id}" class="card-link">\n                                    <div class="card">\n                                          <img src="${t.preview}" class="card-img-top" alt="phones">\n                                          <div class="card-body">\n                                                <h5 class="card-title">${t.name}</h5>\n                                          </div>\n                                    </div>\n                               </a>\n                        </div>\n                  `)}))})(t)})).catch((e=>{console.error("Произошла ошибка")}))})(),(()=>{const o=document.getElementById("cart-modal"),c=document.getElementById("open-cart-btn"),s=o.querySelectorAll(".close-btn"),l=document.getElementById("cart-container");l.innerHTML="",c.addEventListener("click",(()=>{e(o),n("/cart").then((e=>{(e=>{e.forEach((e=>{l.insertAdjacentHTML("beforeend",`\n                        <div class="row border-bottom pb-3 pt-3">\n                              <div class="col col-12 col-md-6 mb-3 mb-md-0 fs-4">${e.name}</div>\n                              <div class="col col-12 col-md-6 fs-4 d-flex align-items-center justify-content-end flex-wrap">\n                                    <h4 class="me-3 d-flex align-itemns-center">${e.price} ₽</h4>\n                                    <button type="button" class="btn btn-outline-dark btn-sm cart-item-controls"\n                                          id="control-dec">\n                                          -\n                                    </button>\n                                    <h6 class="cart-item-count me-3 ms-3">${e.count}</h6>\n                                    <button type="button" class="btn btn-outline-dark btn-sm cart-item-controls"\n                                          id="control-inc">\n                                          +\n                                    </button>\n                              </div>\n                        </div>\n                  `)}))})(e)})).catch((e=>{console.error("Произошла ошибка")}))})),s.forEach((e=>{e.addEventListener("click",(()=>{t(o)}))}))})()})();